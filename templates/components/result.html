<head>
    <link
        rel="stylesheet"
        href="{{ url_for('static', filename='index.css') }}"
    />
</head>

{% if cve_data.id %}

<!-- Do something if cve_data.id exists -->
<h2>
    {{ cve_data.id }}
    <span
        class="cve-status-badge"
        style="background-color: {{ cve_data.status_color }}"
        >{{ cve_data.status }}</span
    >
</h2>
<div>
    <div class="my-3">
        <p class="cvss-badge" style="background-color: {{ cve_data.cvss_color }}">
            {{ cve_data.cvss_score }}
        </p>
    </div>
    <p><b>Vector:</b> {{ cve_data.cvss_vector }}</p>
    <p>
        <b>Published:</b>{{ cve_data.published_on }} <b>Last Modified: </b>{{
        cve_data.last_modified }}
    </p>
    <p><b>Source:</b> {{ cve_data.vuln_source }}</p>
</div>
<p><b>Description:</b></p>
<p class="cve_description">{{ cve_data.description }}</p>
<div class="dropdown">
    <button
        class="btn btn-secondary dropdown-toggle"
        type="button"
        data-bs-toggle="dropdown"
        aria-expanded="false"
    >
        Download Report
    </button>
    <ul class="dropdown-menu">
        <li>
            <a class="dropdown-item" href="/download/pdf">Download as PDF</a>
        </li>
        <li>
            <a class="dropdown-item" href="/download/word">Download as Word</a>
        </li>
    </ul>
</div>

<p>
    View at
    <a target="_blank" href="{{ cve_data.source }}"
        >{{ cve_data.source_label }}<i class="fas fa-external-link-alt"></i
    ></a>
</p>

{% if cve_data.msf_modules %}
<h3>Metasploit modules for {{ cve_data.id }}</h3>

{% for module in cve_data.msf_modules %}
<div class="msf_module_card">
    <p class="msf_module_title">{{ module.title }}</p>
    <p class="msf_module_name">{{ module.module_name }}</p>
    <p>First seen: {{ module.first_seen }}</p>
    <p>Disclosure date: {{ module.disclosure_date }}</p>
    <a target="_blank" href="{{ module.more_info_url }}">More info</a>
</div>
{% endfor %} {% endif %} {% elif cve_data.error %}

<!-- Show something else if cve_data.error exists -->
<p>{{ cve_data.error }}</p>

{% else %}

<!-- Handle the case where neither id nor error exists -->
<p>No ID or Error found.</p>
{% endif %}
